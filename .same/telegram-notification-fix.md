# Исправление проблемы с уведомлениями Telegram

## Проблема
Когда пользователь выбирает вакансию и оставляет заявку в окне, в Telegram приходит уведомление, но содержит "Неизвестная вакансия", неизвестная локация и компания.

## Задачи
- [x] completed: Изучить код отправки заявок на вакансии
- [x] completed: Найти функцию отправки Telegram уведомлений
- [x] completed: Проверить как передаются данные о вакансии в уведомление
- [x] completed: Исправить передачу информации о вакансии, локации и компании
- [x] completed: Протестировать исправления

## Найденная проблема
Код в submit-application.js правильно получает vacancyId и пытается получить данные о вакансии из Firebase, но возможно проблема в том, что:
1. vacancyId передается правильно
2. Логика поиска вакансии в Firebase работает правильно
3. НО возможно есть проблема в том, что функция не может найти документ вакансии в Firebase

Проблема может быть в том, что в Firebase Firestore используется другая структура полей:
- Код ищет: title, company, location
- Но в FirestoreVacancy определен как: title, company, location - всё правильно

Нужно проверить, действительно ли вакансии сохранены в Firebase и доступны ли они.

## Внесенные исправления

1. **Перенес получение данных о вакансии в начало функции** - теперь сначала получаем данные вакансии, а потом используем их для сохранения заявки и Telegram уведомления

2. **Добавил более детальное логирование** для отладки:
   - Логируем тип и длину vacancyId
   - Показываем похожие ID если точный не найден
   - Логируем сырые данные вакансии из Firebase

3. **Добавил поддержку альтернативных полей** в данных вакансии:
   - Для названия: `title`, `name`, `position`
   - Для компании: `company`, `companyName`, `employer`
   - Для локации: `location`, `city`, `address`

4. **Добавил флаг успешности получения данных** (`vacancyFetchSuccess`):
   - Сохраняется в базе данных для отладки
   - Показывается в Telegram уведомлении
   - Отображается в логах функции

5. **Улучшил Telegram сообщение** - теперь показывает статус получения данных о вакансии

6. **Добавил очистку vacancyId** от возможных пробелов

7. **Добавил поиск похожих ID** при отсутствии точного совпадения

## Найденные файлы для анализа
- ApplicationForm.tsx - форма подачи заявки
- ApplicationModal.tsx - модальное окно с формой
- netlify/functions/submit-application.js - функция обработки заявки
- netlify/functions/send-telegram-notification.js - отправка уведомлений
